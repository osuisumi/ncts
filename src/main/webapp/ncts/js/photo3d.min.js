//定义研修模块js
var photo3dJs=$(window).photo3dJs||{};photo3dJs.fn={init:function(){this.publish_argue()},publish_argue:function(d){function b(){$(".am-pb-mod-vp").each(function(a,b){$(this).find(".m-add-opusTl .opus-num").text(a+1);$(this).find(".photo_div").attr("id","photo_div_"+a).attr("paramName","textInfo.textInfoFiles["+a+"].fileInfo");$(this).find(".textInfoFileTitle").attr("name","textInfo.textInfoFiles["+a+"].name");initPhotoUploader("photo_div_"+a,"textInfo.textInfoFiles["+a+"].fileInfo");initPhotoParam("photo_div_"+a,"textInfo.textInfoFiles["+a+"].fileInfo")})}var c=".ag-pbac-lst";""!=d&&"undefined"!=d&&null!=d&&void 0!=d&&(c=d);var a=$(c);(function(){a.on("click",".au-add-vp",function(){$(this).parents(".m-add-opus-ct").before('\x3cli class\x3d"m-add-opus-ct am-pb-mod-vp"\x3e\x3cdiv class\x3d"m-add-opusTl"\x3e\u4f5c\u54c1\x3cspan class\x3d"opus-num"\x3e1\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"m-addElement-item"\x3e\x3cdiv class\x3d"ltxt"\x3e\u4f5c\u54c1\u540d\u79f0\uff1a\x3c/div\x3e\x3cdiv class\x3d"c-center"\x3e\x3cdiv class\x3d"m-pbMod-ipt"\x3e\x3cinput type\x3d"text" value\x3d"" placeholder\x3d"\u8f93\u5165\u6d3b\u52a8\u540d\u79f0" class\x3d"u-pbIpt textInfoFileTitle"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"m-addElement-item last"\x3e\x3cdiv class\x3d"ltxt"\x3e\u4e0a\u4f20\u4f5c\u54c1\uff1a\x3c/div\x3e\x3cdiv class\x3d"photo_div c-center"\x3e\x3cdiv class\x3d"m-pbMod-udload"\x3e\x3ca href\x3d"javascript:void(0);" class\x3d"picker btn u-inverse-btn u-opt-btn"\x3e\x3ci class\x3d"u-upload-ico"\x3e\x3c/i\x3e\u4e0a\u4f20\u538b\u7f29\u5305\x3c/a\x3e\x3c/div\x3e\x3cp class\x3d"m-addElement-ex"\x3e\u6587\u4ef6\u683c\u5f0f\u5fc5\u987b\u4e3azip\uff0crar\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e\x3ca href\x3d"javascript:void(0);" class\x3d"m-add-opus-del"\x3e\x3ci class\x3d"u-delete-ico"\x3e\x3c/i\x3e\x3c/a\x3e\x3c/li\x3e');b()})})();(function(){a.on("click",".m-add-opus-del",function(){if(1==$(".m-add-opus-del").length)return alert("\u81f3\u5c11\u9700\u8981\u4e0a\u4f20\u4e00\u4e2a\u4f5c\u54c1"),!1;var a=$(this);confirm("\u786e\u5b9a\u8981\u5220\u9664\u4f5c\u54c1\u5417?",function(){$vp_mod=a.parents(".am-pb-mod-vp");$vp_mod.remove();b()})})})();b()}};function initPhotoUploader(d,b){var c=WebUploader.create({swf:"/ncts/js/webphoto_uploader/Uploader.swf",server:"/file/uploadTemp",pick:"#"+d+" .picker",resize:!0,duplicate:!0,accept:{extensions:"zip,rar"}});c.on("fileQueued",function(a){if(1<=$("#"+d).find(".fileLi").length)return alert("\u53ea\u5141\u8bb8\u4e0a\u4f201\u4e2a\u9644\u4ef6"),c.removeFile(a.id),!1;var b=$("#photoLiTemplet").clone();b.attr("id",a.id).addClass("fileItem").show();b.find(".fileName").text(a.name);$("#"+d).find(".m-pbMod-udload").remove();$("#"+d).prepend(b);c.upload()});c.on("uploadProgress",function(a,b){var d=$("#"+a.id).find(".fileBar"),c=Math.round(100*b);d.find(".barLength").css("width",c+"%");d.find(".barNum").text(c+"%");d.find(".barTxt").text("\u4e0a\u4f20\u4e2d")});c.on("uploadSuccess",function(a,c){if(null!=c&&"00"==c.responseCode){$("#"+a.id).find(".fileBar").addClass("finish");$("#"+a.id).find(".barTxt").text("\u4e0a\u4f20\u6210\u529f");var e=c.responseData;$("#"+a.id).attr("fileId",e.id);$("#"+a.id).attr("url",e.url);$("#"+a.id).attr("fileName",e.fileName);$("#"+a.id).addClass("success");initPhotoParam(d,b)}});c.on("uploadError",function(a){$("#"+a.id).find(".fileBar").addClass("error");$("#"+a.id).find(".barTxt").text("\u4e0a\u4f20\u51fa\u9519")});c.on("uploadComplete",function(a){$("#"+a.id).find(".progress").fadeOut()});$("#"+d).off("click",".dlt");$("#"+d).on("click",".dlt",function(){$(this);confirm("\u662f\u5426\u786e\u5b9a\u5220\u9664\u8be5\u9644\u4ef6?",function(){$(this).parents(".fileLi").hasClass("fileItem")&&c.removeFile($(this).parents(".fileLi").attr("id"));$("#"+d).find(".fileLi").remove();$("#"+d).prepend($('\x3cdiv class\x3d"m-pbMod-udload"\x3e\x3ca href\x3d"javascript:void(0);" class\x3d"picker btn u-inverse-btn u-opt-btn"\x3e\x3ci class\x3d"u-upload-ico"\x3e\x3c/i\x3e\u4e0a\u4f20\u538b\u7f29\u5305\x3c/a\x3e\x3c/div\x3e'));initPhotoUploader(d,b);initPhotoParam(d,b)})});c.on("error",function(a){"Q_TYPE_DENIED"==a&&alert("\u8bf7\u68c0\u67e5\u4e0a\u4f20\u7684\u6587\u4ef6\u7c7b\u578b")})}function initPhotoParam(d,b){var c=$("#"+d);c.find(".fileParam").remove();c.find(".fileLi.success").each(function(a){a=$(this).attr("fileId");var c=$(this).attr("fileName"),d=$(this).attr("url");$(this).append('\x3cinput class\x3d"fileParam" name\x3d"'+b+'.id" value\x3d"'+a+'" type\x3d"hidden"/\x3e');$(this).append('\x3cinput class\x3d"fileParam" name\x3d"'+b+'.fileName" value\x3d"'+c+'" type\x3d"hidden"/\x3e');$(this).append('\x3cinput class\x3d"fileParam" name\x3d"'+b+'.url" value\x3d"'+d+'" type\x3d"hidden"/\x3e')});initFileType(c)}function initFileType(d){d.find(".fileLi").each(function(){var b=$(this),c=b.find(".fileName").text(),b=b.find(".fileIcon"),a=c.split("."),c=a.length,a=a[c-1];1!=c&&("doc"==a||"docx"==a?b.addClass("doc"):"xls"==a||"xlsx"==a?b.addClass("excel"):"ppt"==a||"pptx"==a?b.addClass("ppt"):"pdf"==a?b.addClass("pdf"):"txt"==a?b.addClass("txt"):"zip"==a||"rar"==a?b.addClass("zip"):"jpg"==a||"jpeg"==a||"png"==a||"gif"==a?b.addClass("pic"):"mp4"==a||"avi"==a||"rmvb"==a||"rm"==a||"asf"==a||"divx"==a||"mpg"==a||"mpeg"==a||"mpe"==a||"wmv"==a||"mkv"==a||"vob"==a||"3gp"==a?b.addClass("video"):b.addClass("other"))})};